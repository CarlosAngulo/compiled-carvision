(self.webpackChunkcar_sales_front=self.webpackChunkcar_sales_front||[]).push([[64],{3064:(Ot,kt,w)=>{"use strict";w.r(kt),w.d(kt,{AdminModule:()=>Ft});var mt=w(7006),j=w(6814),S=w(6223),l=w(2210),ft=w(7023),vt=w(5256),t=w(5879);function Zt(r,f){if(1&r&&t._UZ(0,"nb-icon",8),2&r){const e=t.oxw();t.Q6J("icon",e.icon+"-outline")}}function x(r,f){if(1&r){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.ref.close(!1))}),t._uU(1,"Cancel "),t.qZA()}}let _t=(()=>{class r{constructor(e){this.ref=e,this.title="",this.message="",this.cancelBtn=!0}static#t=this.\u0275fac=function(n){return new(n||r)(t.Y36(l.X4l))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-confirm-dialog"]],decls:12,vars:4,consts:[[1,"p-6","flex","flex-col","gap-1","items-center"],["class","text-5xl",3,"icon",4,"ngIf"],[1,"text-center"],[1,"p-6"],[3,"innerHTML"],[1,"flex","gap-3","p-4"],["nbButton","","status","primary",1,"grow",3,"click"],["nbButton","","class","grow","status","danger",3,"click",4,"ngIf"],[1,"text-5xl",3,"icon"],["nbButton","","status","danger",1,"grow",3,"click"]],template:function(n,i){1&n&&(t.TgZ(0,"nb-card")(1,"nb-card-header",0),t.YNc(2,Zt,1,1,"nb-icon",1),t.TgZ(3,"h4",2),t._uU(4),t.qZA()(),t.TgZ(5,"nb-card-body",3),t._UZ(6,"div",4),t.qZA(),t.TgZ(7,"nb-card-footer")(8,"div",5)(9,"button",6),t.NdJ("click",function(){return i.ref.close(!0)}),t._uU(10,"Aceptar "),t.qZA(),t.YNc(11,x,2,0,"button",7),t.qZA()()()),2&n&&(t.xp6(2),t.Q6J("ngIf",i.icon),t.xp6(2),t.hij(" ",i.title," "),t.xp6(2),t.Q6J("innerHTML",i.message,t.oJD),t.xp6(5),t.Q6J("ngIf",i.cancelBtn))},dependencies:[j.O5,l.Asz,l.yKW,l.XWE,l.ndF,l.DPz,l.fMN],styles:["nb-card[_ngcontent-%COMP%]{border-radius:20px}nb-card[_ngcontent-%COMP%]   nb-card-header[_ngcontent-%COMP%]{padding:24px;text-align:center}"]})}return r})();var Y=w(4664),nt=w(2096);class ot{}var gt=w(8645),bt=w(9773),wt=w(6306),pt=w(8033);let yt=(()=>{class r{constructor(e,n){this.formBuilder=e,this.usersService=n,this.onUserCreated=new t.vpe,this.onCancelCreation=new t.vpe,this.isAdmin=!1,this.unsubscribe$=new gt.x,this.roles=[{text:"Regular User",value:"user"},{text:"Administrator",value:"admin"}]}ngOnInit(){this.createUserForm=this.formBuilder.group({name:["",[S.kI.required]],email:["",[S.kI.required,S.kI.pattern(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/)]],role:["user",[S.kI.required]]})}ngAfterViewInit(){this.user&&this.preFillOut(this.user)}preFillOut(e){e&&(this.createUserForm.patchValue({email:e.email,name:e.name,role:e.role}),this.isAdmin=e.role===pt.G.ADMIN)}onRoleChange(e){this.createUserForm.get("role")?.patchValue(e?pt.G.ADMIN:pt.G.USER)}onCancel(){this.clearForm(),this.onCancelCreation.next()}onSubmit(){if(this.createUserForm.valid){const e=this.createUserForm.get("name")?.value,n=this.createUserForm.get("email")?.value,i=this.createUserForm.get("role")?.value;(this.user?this.usersService.updateUser({id:this.user.id,name:e,email:n,role:i}):this.usersService.createUser(e,n,i)).pipe((0,bt.R)(this.unsubscribe$),(0,wt.K)(u=>(0,nt.of)(u.error))).subscribe(u=>{u.id&&(this.clearForm(),this.onUserCreated.next(u))})}}clearForm(){this.createUserForm.reset(this.createUserForm.value)}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}ngOnChanges(e){const n=e.user?.currentValue;n&&this.createUserForm&&this.preFillOut(n)}static#t=this.\u0275fac=function(n){return new(n||r)(t.Y36(S.qu),t.Y36(ot))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-new-user"]],inputs:{user:"user"},outputs:{onUserCreated:"onUserCreated",onCancelCreation:"onCancelCreation"},features:[t.TTD],decls:20,vars:2,consts:[[1,"mb-3"],[1,"flex","flex-col","gap-4","xl:flex-row",3,"formGroup","ngSubmit"],[1,"flex","flex-col","gap-4","justify-between","lg:flex-row","flex-grow"],[1,"flex-grow"],["nbInput","","fullWidth","","type","text","fieldSize","medium","placeholder","Name","formControlName","name"],["nbInput","","fullWidth","","type","text","fieldSize","medium","placeholder","Email","formControlName","email"],[1,"flex","flex-grow","items-center","gap-4","justify-center"],["status","primary","labelPosition","start",3,"checked","checkedChange"],[1,"flex","gap-4","items-center","justify-end"],["nbButton","","size","medium",3,"click"],["icon","close-outline"],["nbButton","","status","primary","size","medium","type","submit"],["icon","save-outline"]],template:function(n,i){1&n&&(t.TgZ(0,"nb-card")(1,"nb-card-body")(2,"h4",0),t._uU(3,"New user"),t.qZA(),t.TgZ(4,"form",1),t.NdJ("ngSubmit",function(){return i.onSubmit()}),t.TgZ(5,"div",2)(6,"div",3),t._UZ(7,"input",4),t.qZA(),t.TgZ(8,"div",3),t._UZ(9,"input",5),t.qZA(),t.TgZ(10,"div",6)(11,"nb-toggle",7),t.NdJ("checkedChange",function(u){return i.onRoleChange(u)}),t._uU(12," Is Admin? "),t.qZA()()(),t.TgZ(13,"div",8)(14,"button",9),t.NdJ("click",function(){return i.onCancel()}),t._UZ(15,"nb-icon",10),t._uU(16," Cancel "),t.qZA(),t.TgZ(17,"button",11),t._UZ(18,"nb-icon",12),t._uU(19," Save "),t.qZA()()()()()),2&n&&(t.xp6(4),t.Q6J("formGroup",i.createUserForm),t.xp6(7),t.Q6J("checked",i.isAdmin))},dependencies:[S._Y,S.Fj,S.JJ,S.JL,S.sg,S.u,l.Asz,l.yKW,l.DPz,l.fMN,l.h8i,l.BLq],styles:[".new-user[_ngcontent-%COMP%]{border:1px dashed #CCC;box-shadow:1px 1px 4px #0003;background-color:#d3e0eb;margin-bottom:4px}.new-user-input[_ngcontent-%COMP%]{border:1px solid #CCC;background-color:#fff;border-radius:4px;padding:6px;width:100%}.new-user-input.ng-invalid[_ngcontent-%COMP%]{border-color:red}.new-user-input.ng-pristine[_ngcontent-%COMP%]{border:1px solid #CCC}"]})}return r})();function Et(r,f){if(1&r){const e=t.EpF();t.TgZ(0,"app-new-user",7),t.NdJ("onCancelCreation",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.hideAddUser())})("onUserCreated",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.userCreated(i))}),t.qZA()}if(2&r){const e=t.oxw();t.Q6J("user",e.userToEdit)}}function At(r,f){if(1&r){const e=t.EpF();t.TgZ(0,"nb-card")(1,"nb-card-body")(2,"div",8),t._UZ(3,"nb-user",9),t.TgZ(4,"div",10)(5,"span"),t._uU(6),t.qZA(),t.TgZ(7,"button",11),t.NdJ("click",function(){const a=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.deleteUser(a.id))}),t._UZ(8,"nb-icon",12),t.qZA(),t.TgZ(9,"button",13),t.NdJ("click",function(){const a=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.editUser(a.id))}),t._UZ(10,"nb-icon",14),t.qZA(),t.TgZ(11,"button",15),t.NdJ("click",function(){const a=t.CHM(e).$implicit,u=t.oxw();return t.KtG(u.emailUser(a.id,a.name))}),t._UZ(12,"nb-icon",16),t.qZA()()()()()}if(2&r){const e=f.$implicit;t.xp6(3),t.Q6J("name",e.name)("title",e.role),t.xp6(3),t.Oqu(e.email)}}let St=(()=>{class r{constructor(e,n,i){this.usersService=e,this.dialogService=n,this.toastrService=i,this.showCreateUserComponent=!1,this.toastrPositions=l.fe3,this.loadUsers();const a=localStorage.getItem("auth_app_token");a&&(this.currentUserId=JSON.parse(a).value.user.id)}loadUsers(){this.usersService.getAll("sortBy=createdAt:desc").subscribe(e=>{this.users=e.results.filter(n=>n.id!==this.currentUserId)})}onAddUserClick(){this.userToEdit=void 0,this.showCreateUserComponent=!0}hideAddUser(){this.showCreateUserComponent=!1}userCreated(e){this.showToastr("The user has created"),this.hideAddUser(),this.loadUsers()}deleteUser(e){this.dialogService.open(_t,{context:{icon:"alert-triangle",title:"Delete User",message:"<p>Are you sure you want to delete this user?</p>\n        <p>This element cannot be recovered after this operation.</p>"}}).onClose.pipe((0,Y.w)(n=>n?this.usersService.deleteUser(e):(0,nt.of)(!1))).subscribe(n=>{if(n.success)return this.showToastr("The user has been removed successfully"),void this.loadUsers();n.usedIn&&this.toastrService.show("Error",`This user has ${n.usedIn} reviews assigned`,{position:this.toastrPositions.BOTTOM_LEFT,status:"danger"})})}emailUser(e,n){this.showToastr(`The reset password has been sent to ${n}`)}editUser(e){this.usersService.getById(e).subscribe(n=>{this.showCreateUserComponent=!0,this.userToEdit=n})}showToastr(e,n="Success",i=this.toastrPositions.BOTTOM_LEFT){this.toastrService.show(n,e,{position:i,status:n.toLowerCase()})}static#t=this.\u0275fac=function(n){return new(n||r)(t.Y36(ot),t.Y36(l.Gln),t.Y36(l.quB))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-users"]],decls:9,vars:2,consts:[[1,"user-actions"],["nbPrefix","","icon","person-outline","pack","eva"],["type","text","nbInput","","fieldSize","large","placeholder","Search user"],["nbButton","","status","primary","size","large",3,"click"],["icon","plus"],[3,"user","onCancelCreation","onUserCreated",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"user","onCancelCreation","onUserCreated"],[1,"card-content"],["size","large","badgeStatus","success","badgePosition","bottom right",3,"name","title"],[1,"card-actions","gap-3"],["nbButton","","nbPopover","Delete user","nbPopoverTrigger","hint","nbPopoverPlacement","top",3,"click"],["icon","trash-2-outline"],["nbButton","","nbPopover","Edit user","nbPopoverTrigger","hint","nbPopoverPlacement","top",3,"click"],["icon","edit-outline"],["nbButton","","nbPopover","Reset password","nbPopoverTrigger","hint","nbPopoverPlacement","top",3,"click"],["icon","email-outline"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"nb-form-field"),t._UZ(2,"nb-icon",1)(3,"input",2),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return i.onAddUserClick()}),t._UZ(5,"nb-icon",4),t._uU(6," Add User "),t.qZA()(),t.YNc(7,Et,1,1,"app-new-user",5),t.YNc(8,At,13,3,"nb-card",6)),2&n&&(t.xp6(7),t.Q6J("ngIf",i.showCreateUserComponent),t.xp6(1),t.Q6J("ngForOf",i.users))},dependencies:[j.sg,j.O5,l.Asz,l.yKW,l.DPz,l.fMN,l.k0$,l.jBG,l.t3q,l.h8i,l.ydg,yt],styles:[".card-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.card-actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:1.25rem}.user-actions[_ngcontent-%COMP%]{margin-bottom:var(--card-margin-bottom);display:flex;justify-content:space-between}"]})}return r})();var Tt=w(9397),st=w(9315),T=w(9987);class s{constructor(f){this._customMapping={"Last Response Date":{label:"lastResponse",type:"date"},"Make Sold/Serviced":{label:"solidService",type:"string"},"Positive?":{label:"positive",type:"boolean"},"Private Messages":{label:"privateMessages",type:"number"},"Public Messages":{label:"publicMessages",type:"number"},Rating:{label:"rating",type:"number"},Reported:{label:"reported",type:"boolean"},"Screen Name":{label:"client",type:"string"},Source:{label:"platform",type:"string"},Submitted:{label:"submitted",type:"date"},Tagged:{label:"tagged",type:"number"},Facebook:{label:"facebook",type:"string"}},this._obj=f}get mapped(){return this._obj.map(f=>{const e={};for(const n in f)n in this._customMapping?e[this._customMapping[n].label]=this.mapType(f[n],this._customMapping[n].type):e[n]=f[n];return e})}get customMapping(){return this._customMapping}mapType(f,e){if(""===f.trim())return;let n;switch(e){case"string":default:n=f;break;case"number":n=isNaN(Number(f))?void 0:Number(f);break;case"boolean":n="yes"===f.toLowerCase();break;case"date":const i=new Date(f);n=isNaN(i.getTime())?void 0:i}return n}}var o=w(1768);class c{}var p=w(4316),_=w.t(p,2);let b=(()=>{class r{constructor(){this._papa=_}parse(e,n){return this._papa.parse(e,n)}unparse(e,n){return this._papa.unparse(e,n)}setLocalChunkSize(e){this._papa.LocalChunkSize=e}setRemoteChunkSize(e){this._papa.RemoteChunkSize=e}setDefaultDelimiter(e){this._papa.DefaultDelimiter=e}get badDelimiters(){return this._papa.BAD_DELIMITERS}get recordSeparator(){return this._papa.RECORD_SEP}get unitSeparator(){return this._papa.UNIT_SEP}get workersSupported(){return this._papa.WORKERS_SUPPORTED}static#t=this.\u0275fac=function(n){return new(n||r)};static#e=this.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var C=w(7398);const $=["autoInput"];function U(r,f){if(1&r&&(t.TgZ(0,"nb-option",5),t._uU(1),t.qZA()),2&r){const e=f.$implicit;t.Q6J("value",e.label),t.xp6(1),t.hij(" ",e.label," ")}}let P=(()=>{class r{constructor(){this.onOptionChange=new t.vpe,this.defaultValue=""}filterUsers(e){const n="string"==typeof e?e.toLowerCase():e.label.toLowerCase();return this.options.filter(i=>i.label.toLowerCase().includes(n))}ngOnInit(){this.filteredOptions$=(0,nt.of)(this.options)}ngOnChanges(e){("value"in e||"options"in e)&&this.selectOptionFromValue()}selectOptionFromValue(){if(this.options&&null!=this.value){const e="object"==typeof this.value&&"label"in this.value&&"value"in this.value?this.value.value:this.value,n=this.options.find(i=>i.value===e);this.defaultValue=n?.label||""}}onChange(){this.filteredOptions$=this.getFilteredUsers(this.input.nativeElement.value)}onSelectionChange(e){this.filteredOptions$=this.getFilteredUsers(e),this.filteredOptions$.subscribe(n=>this.onOptionChange.next(n[0]))}getFilteredUsers(e){return(0,nt.of)(e).pipe((0,C.U)(n=>this.filterUsers(n)))}static#t=this.\u0275fac=function(n){return new(n||r)};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-dropdown"]],viewQuery:function(n,i){if(1&n&&t.Gf($,5),2&n){let a;t.iGM(a=t.CRH())&&(i.input=a.first)}},inputs:{value:"value",fieldSize:"fieldSize",class:"class",options:"options"},outputs:{onOptionChange:"onOptionChange"},features:[t.TTD],decls:6,vars:8,consts:[["nbInput","","type","text",3,"value","fieldSize","nbAutocomplete","input"],["autoInput",""],[3,"selectedChange"],["auto",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(n,i){if(1&n&&(t.TgZ(0,"input",0,1),t.NdJ("input",function(){return i.onChange()}),t.qZA(),t.TgZ(2,"nb-autocomplete",2,3),t.NdJ("selectedChange",function(u){return i.onSelectionChange(u)}),t.YNc(4,U,2,2,"nb-option",4),t.ALo(5,"async"),t.qZA()),2&n){const a=t.MAs(3);t.Tol(i.class),t.Q6J("value",i.defaultValue)("fieldSize",i.fieldSize)("nbAutocomplete",a),t.xp6(4),t.Q6J("ngForOf",t.lcZ(5,6,i.filteredOptions$))}},dependencies:[j.sg,l.h8i,l.Xh,l.wNd,l.q51,j.Ov]})}return r})();function m(r,f){if(1&r){const e=t.EpF();t.TgZ(0,"li",8),t.NdJ("click",function(){const a=t.CHM(e).$implicit,u=t.oxw(2);return t.KtG(u.onPageClick(a))}),t._uU(1),t.qZA()}if(2&r){const e=f.$implicit,n=t.oxw(2);t.ekj("active",e===n.currentPage),t.xp6(1),t.hij(" ",e," ")}}function X(r,f){if(1&r){const e=t.EpF();t.TgZ(0,"div",1)(1,"ul",2),t.YNc(2,m,2,3,"li",3),t.qZA(),t.TgZ(3,"div",4)(4,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onChangePage(-1))}),t._UZ(5,"nb-icon",6),t.qZA(),t.TgZ(6,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onChangePage(1))}),t._UZ(7,"nb-icon",7),t.qZA()()()}if(2&r){const e=t.oxw();t.xp6(2),t.Q6J("ngForOf",e.pageList),t.xp6(2),t.Q6J("disabled",1===e.currentPage),t.xp6(2),t.Q6J("disabled",e.currentPage===e.pageList.length)}}let B=(()=>{class r{constructor(){this.onPageChange=new t.vpe}set pagination(e){e&&(this.currentPage=e.page,this.pageList=Array(e.totalPages).fill(0,0,e.totalPages).map((n,i)=>i+1))}onPageClick(e){this.onPageChange.emit(e)}onChangePage(e){this.onPageChange.emit(this.currentPage+e)}static#t=this.\u0275fac=function(n){return new(n||r)};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-pagination"]],inputs:{currentPage:"currentPage",pagination:"pagination"},outputs:{onPageChange:"onPageChange"},decls:1,vars:1,consts:[["class","pagination",4,"ngIf"],[1,"pagination"],[1,"pagination-list"],["class","pagination-list-item",3,"active","click",4,"ngFor","ngForOf"],[1,"pagination-buttons"],["nbButton","","status","primary","shape","semi-round",3,"disabled","click"],["icon","arrow-ios-back-outline"],["icon","arrow-ios-forward-outline"],[1,"pagination-list-item",3,"click"]],template:function(n,i){1&n&&t.YNc(0,X,8,3,"div",0),2&n&&t.Q6J("ngIf",i.currentPage&&i.pageList.length>1)},dependencies:[j.sg,j.O5,l.DPz,l.fMN],styles:[".pagination[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.pagination-list[_ngcontent-%COMP%], .pagination-buttons[_ngcontent-%COMP%]{padding:6px;border:1px solid rgba(0,0,0,.05);border-radius:16px;display:flex;gap:6px}.pagination-list-item[_ngcontent-%COMP%], .pagination-buttons-item[_ngcontent-%COMP%]{cursor:pointer;width:44px;height:44px;display:flex;align-items:center;justify-content:center;border-radius:12px;background-color:#fff;border:1px solid rgba(0,0,0,.1)}.pagination-list-item[_ngcontent-%COMP%]:hover, .pagination-buttons-item[_ngcontent-%COMP%]:hover{background-color:#fafafa}.pagination-list-item.active[_ngcontent-%COMP%], .pagination-buttons-item.active[_ngcontent-%COMP%]{border:medium none;background-color:#8b5cf6;color:#fff}.pagination-list-item.disabled[_ngcontent-%COMP%], .pagination-buttons-item.disabled[_ngcontent-%COMP%]{opacity:.4;cursor:default}"]})}return r})(),d=(()=>{class r{transform(e){return e?"yes":"no"}static#t=this.\u0275fac=function(n){return new(n||r)};static#e=this.\u0275pipe=t.Yjl({name:"booleanToString",type:r,pure:!0})}return r})(),E=(()=>{class r{transform(e){return"string"==typeof e?e:e&&e.name?e.name:""}static#t=this.\u0275fac=function(n){return new(n||r)};static#e=this.\u0275pipe=t.Yjl({name:"userName",type:r,pure:!0})}return r})(),q=(()=>{class r{transform(e,n){return void 0!==e?{label:e[n[0]],value:e[n[1]]}:""}static#t=this.\u0275fac=function(n){return new(n||r)};static#e=this.\u0275pipe=t.Yjl({name:"dropdownOption",type:r,pure:!0})}return r})();function N(r,f){if(1&r&&(t.TgZ(0,"nb-option",19),t._uU(1),t.qZA()),2&r){const e=f.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.label," ")}}function L(r,f){if(1&r){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",11)(2,"nb-form-field"),t._UZ(3,"nb-icon",12),t.TgZ(4,"nb-select",13),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.selectedStore=i)}),t.YNc(5,N,2,2,"nb-option",14),t.qZA()(),t.TgZ(6,"button",15),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onSaveImport())}),t._UZ(7,"nb-icon",16),t._uU(8," Save "),t.qZA(),t.TgZ(9,"button",17),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onCancelImport())}),t._UZ(10,"nb-icon",18),t._uU(11," Cancel "),t.qZA()(),t.BQk()}if(2&r){const e=t.oxw();t.xp6(4),t.Q6J("ngModel",e.selectedStore),t.xp6(1),t.Q6J("ngForOf",e.stores),t.xp6(1),t.Q6J("nbPopover",e.selectedStore?"":"Please select a Store")("disabled",!e.selectedStore)}}function D(r,f){if(1&r&&(t.TgZ(0,"nb-option",19),t._uU(1),t.qZA()),2&r){const e=f.$implicit;t.Q6J("value",e.value),t.xp6(1),t.hij(" ",e.label," ")}}function z(r,f){if(1&r){const e=t.EpF();t.TgZ(0,"div",20)(1,"div",21)(2,"nb-form-field"),t._UZ(3,"nb-icon",12),t.TgZ(4,"nb-select",22),t.NdJ("ngModelChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.selectedStore=i)})("selectedChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onStoreSelect(i))}),t.YNc(5,D,2,2,"nb-option",14),t.qZA()()(),t.TgZ(6,"div",21)(7,"input",23,24),t.NdJ("change",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.onFileSelected(i))}),t.qZA(),t.TgZ(9,"button",25),t.NdJ("click",function(){t.CHM(e);const i=t.MAs(8);return t.KtG(i.click())}),t._UZ(10,"nb-icon",26),t._uU(11," Upload "),t.qZA(),t.TgZ(12,"button",25),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.showAddReport())}),t._UZ(13,"nb-icon",27),t._uU(14," Add Line "),t.qZA()()()}if(2&r){const e=t.oxw();t.xp6(4),t.Q6J("ngModel",e.selectedStore),t.xp6(1),t.Q6J("ngForOf",e.stores)}}function g(r,f){if(1&r&&(t.TgZ(0,"th",28),t._uU(1),t.qZA()),2&r){const e=f.$implicit;t.xp6(1),t.hij(" ",e," ")}}function y(r,f){if(1&r){const e=t.EpF();t.ynx(0),t.TgZ(1,"tr",29)(2,"td",30),t._UZ(3,"input",31),t.qZA(),t.TgZ(4,"td",30)(5,"app-dropdown",32),t.NdJ("onOptionChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.updateNewReport(i,"salesPerson"))}),t.qZA()(),t.TgZ(6,"td",33)(7,"app-dropdown",32),t.NdJ("onOptionChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.updateNewReport(i,"picture"))}),t.qZA()(),t.TgZ(8,"td",33),t._UZ(9,"input",34),t.qZA(),t.TgZ(10,"td",35)(11,"app-dropdown",32),t.NdJ("onOptionChange",function(i){t.CHM(e);const a=t.oxw();return t.KtG(a.updateNewReport(i,"positive"))}),t.qZA()(),t.TgZ(12,"td",35),t._UZ(13,"input",36),t.qZA(),t.TgZ(14,"td",35),t._UZ(15,"input",37)(16,"nb-datepicker",null,38),t.qZA(),t.TgZ(18,"td",35),t._UZ(19,"input",39),t.qZA(),t.TgZ(20,"td")(21,"div",40)(22,"button",41),t._UZ(23,"nb-icon",16),t.qZA(),t.TgZ(24,"button",42),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.showAddReport(!1))}),t._UZ(25,"nb-icon",18),t.qZA()()()(),t.BQk()}if(2&r){const e=t.MAs(17),n=t.oxw();t.xp6(5),t.Q6J("fieldSize","small")("options",n.salesPeople),t.xp6(2),t.Tol("w-20 text-center"),t.Q6J("fieldSize","small")("options",n.booleanDropOptions),t.xp6(4),t.Tol("w-20 text-center"),t.Q6J("fieldSize","small")("options",n.booleanDropOptions),t.xp6(4),t.Q6J("nbDatepicker",e)}}function M(r,f){if(1&r){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",56),t.NdJ("blur",function(i){t.CHM(e);const a=t.oxw(),u=a.$implicit,v=a.index,k=t.oxw();return t.KtG(k.updateReport(i,"client",u.id||v,!0))})("keydown.enter",function(i){t.CHM(e);const a=t.oxw(),u=a.$implicit,v=a.index,k=t.oxw();return t.KtG(k.updateReport(i,"client",u.id||v,!0))}),t.qZA(),t.BQk()}if(2&r){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("value",e.client||"")}}function J(r,f){if(1&r&&t._uU(0),2&r){const e=t.oxw().$implicit;t.hij(" ",e.client," ")}}const A=function(){return["name","id"]};function Q(r,f){if(1&r){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-dropdown",57),t.NdJ("onOptionChange",function(i){t.CHM(e);const a=t.oxw(),u=a.$implicit,v=a.index,k=t.oxw();return t.KtG(k.updateReport(i,"salesPerson",u.id||v))}),t.ALo(2,"dropdownOption"),t.qZA(),t.BQk()}if(2&r){const e=t.oxw().$implicit,n=t.oxw();t.xp6(1),t.Q6J("value",t.xi3(2,3,e.salesPerson,t.DdM(6,A)))("fieldSize","small")("options",n.salesPeople)}}function I(r,f){if(1&r&&(t._uU(0),t.ALo(1,"userName")),2&r){const e=t.oxw().$implicit;t.hij(" ",t.lcZ(1,1,e.salesPerson)," ")}}function Z(r,f){if(1&r){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-dropdown",57),t.NdJ("onOptionChange",function(i){t.CHM(e);const a=t.oxw(),u=a.$implicit,v=a.index,k=t.oxw();return t.KtG(k.updateReport(i,"picture",u.id||v))}),t.qZA(),t.BQk()}if(2&r){const e=t.oxw().$implicit,n=t.oxw();t.xp6(1),t.Tol("w-20 text-center"),t.Q6J("value",e.picture)("fieldSize","small")("options",n.booleanDropOptions)}}function tt(r,f){if(1&r&&(t._uU(0),t.ALo(1,"booleanToString")),2&r){const e=t.oxw().$implicit;t.hij(" ",t.lcZ(1,1,e.picture)," ")}}function H(r,f){if(1&r){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",58),t.NdJ("blur",function(i){t.CHM(e);const a=t.oxw(),u=a.$implicit,v=a.index,k=t.oxw();return t.KtG(k.updateReport(i,"paid",u.id||v,!0))})("keydown.enter",function(i){t.CHM(e);const a=t.oxw(),u=a.$implicit,v=a.index,k=t.oxw();return t.KtG(k.updateReport(i,"paid",u.id||v,!0))}),t.qZA(),t.BQk()}if(2&r){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("value",e.paid||"")}}function et(r,f){if(1&r&&t._uU(0),2&r){const e=t.oxw().$implicit;t.hij(" ",e.paid," ")}}function rt(r,f){if(1&r){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-dropdown",59),t.NdJ("onOptionChange",function(i){t.CHM(e);const a=t.oxw(),u=a.$implicit,v=a.index,k=t.oxw();return t.KtG(k.updateReport(i,"positive",u.id||v))}),t.qZA(),t.BQk()}if(2&r){const e=t.oxw().$implicit,n=t.oxw();t.xp6(1),t.Tol("w-20 text-center"),t.Q6J("fieldSize","small")("value",e.positive)("options",n.booleanDropOptions)}}function G(r,f){if(1&r&&(t._uU(0),t.ALo(1,"booleanToString")),2&r){const e=t.oxw().$implicit;t.hij(" ",t.lcZ(1,1,e.positive)," ")}}function O(r,f){if(1&r){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",58),t.NdJ("blur",function(i){t.CHM(e);const a=t.oxw(),u=a.$implicit,v=a.index,k=t.oxw();return t.KtG(k.updateReport(i,"rating",u.id||v,!0))})("keydown.enter",function(i){t.CHM(e);const a=t.oxw(),u=a.$implicit,v=a.index,k=t.oxw();return t.KtG(k.updateReport(i,"rating",u.id||v,!0))}),t.qZA(),t.BQk()}if(2&r){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("value",e.rating||"")}}function F(r,f){if(1&r&&t._uU(0),2&r){const e=t.oxw().$implicit;t.hij(" ",e.rating," ")}}function ut(r,f){if(1&r){const e=t.EpF();t.ynx(0),t._UZ(1,"input",60),t.ALo(2,"date"),t.TgZ(3,"nb-datepicker",61,38),t.NdJ("dateChange",function(i){t.CHM(e);const a=t.oxw(),u=a.$implicit,v=a.index,k=t.oxw();return t.KtG(k.updateReport(i,"submitted",u.id||v))}),t.qZA(),t.BQk()}if(2&r){const e=t.MAs(4),n=t.oxw().$implicit;t.xp6(1),t.Q6J("value",t.xi3(2,2,n.submitted,"mediumDate"))("nbDatepicker",e)}}function R(r,f){if(1&r&&(t._uU(0),t.ALo(1,"date")),2&r){const e=t.oxw().$implicit;t.hij(" ",t.xi3(1,1,e.submitted,"mediumDate")," ")}}function ht(r,f){if(1&r){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",62),t.NdJ("blur",function(i){t.CHM(e);const a=t.oxw(),u=a.$implicit,v=a.index,k=t.oxw();return t.KtG(k.updateReport(i,"platform",u.id||v,!0))})("keydown.enter",function(i){t.CHM(e);const a=t.oxw(),u=a.$implicit,v=a.index,k=t.oxw();return t.KtG(k.updateReport(i,"platform",u.id||v,!0))}),t.qZA(),t.BQk()}if(2&r){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("value",e.platform||"")}}function it(r,f){if(1&r&&t._uU(0),2&r){const e=t.oxw().$implicit;t.hij(" ",e.platform," ")}}function dt(r,f){if(1&r){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",63),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onEditReportRecordSubmit())}),t._UZ(2,"nb-icon",16),t.qZA(),t.TgZ(3,"button",64),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.editReport())}),t._UZ(4,"nb-icon",18),t.qZA(),t.BQk()}}function at(r,f){if(1&r){const e=t.EpF();t.TgZ(0,"button",63),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2).$implicit,a=t.oxw();return t.KtG(a.editReport(i.id))}),t._UZ(1,"nb-icon",68),t.qZA()}}function ct(r,f){if(1&r){const e=t.EpF();t.YNc(0,at,2,0,"button",65),t.TgZ(1,"button",66),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(),a=i.$implicit,u=i.index,v=t.oxw();return t.KtG(v.deleteRegister(a.id,u))}),t._UZ(2,"nb-icon",67),t.qZA()}if(2&r){const e=t.oxw(2);t.Q6J("ngIf",!e.revisionMode)}}function lt(r,f){if(1&r&&(t.TgZ(0,"tr")(1,"td",43),t.YNc(2,M,2,1,"ng-container",1),t.YNc(3,J,1,1,"ng-template",null,44,t.W1O),t.qZA(),t.TgZ(5,"td",43),t.YNc(6,Q,3,7,"ng-container",1),t.YNc(7,I,2,3,"ng-template",null,45,t.W1O),t.qZA(),t.TgZ(9,"td",46),t.YNc(10,Z,2,5,"ng-container",1),t.YNc(11,tt,2,3,"ng-template",null,47,t.W1O),t.qZA(),t.TgZ(13,"td",46),t.YNc(14,H,2,1,"ng-container",1),t.YNc(15,et,1,1,"ng-template",null,48,t.W1O),t.qZA(),t.TgZ(17,"td",46),t.YNc(18,rt,2,5,"ng-container",1),t.YNc(19,G,2,3,"ng-template",null,49,t.W1O),t.qZA(),t.TgZ(21,"td",50),t.YNc(22,O,2,1,"ng-container",1),t.YNc(23,F,1,1,"ng-template",null,51,t.W1O),t.qZA(),t.TgZ(25,"td",50),t.YNc(26,ut,5,5,"ng-container",1),t.YNc(27,R,2,4,"ng-template",null,52,t.W1O),t.qZA(),t.TgZ(29,"td",50),t.YNc(30,ht,2,1,"ng-container",1),t.YNc(31,it,1,1,"ng-template",null,53,t.W1O),t.qZA(),t.TgZ(33,"td",54)(34,"div",40),t.YNc(35,dt,5,0,"ng-container",1),t.YNc(36,ct,3,1,"ng-template",null,55,t.W1O),t.qZA()()()),2&r){const e=f.$implicit,n=t.MAs(4),i=t.MAs(8),a=t.MAs(12),u=t.MAs(16),v=t.MAs(20),k=t.MAs(24),Mt=t.MAs(28),Jt=t.MAs(32),Dt=t.MAs(37),K=t.oxw();t.ekj("bg-violet-100",K.currentReportEdit===e.id),t.xp6(2),t.Q6J("ngIf",K.currentReportEdit===e.id||!e.client||K.revisionMode)("ngIfElse",n),t.xp6(4),t.Q6J("ngIf",K.currentReportEdit===e.id||!e.salesPerson||K.revisionMode)("ngIfElse",i),t.xp6(4),t.Q6J("ngIf",K.currentReportEdit===e.id||null==e.picture||K.revisionMode)("ngIfElse",a),t.xp6(4),t.Q6J("ngIf",K.currentReportEdit===e.id||!e.paid||K.revisionMode)("ngIfElse",u),t.xp6(4),t.Q6J("ngIf",K.currentReportEdit===e.id||null==e.positive||K.revisionMode)("ngIfElse",v),t.xp6(4),t.Q6J("ngIf",K.currentReportEdit===e.id||!e.rating||K.revisionMode)("ngIfElse",k),t.xp6(4),t.Q6J("ngIf",K.currentReportEdit===e.id||!e.submitted||K.revisionMode)("ngIfElse",Mt),t.xp6(4),t.Q6J("ngIf",K.currentReportEdit===e.id||!e.platform||K.revisionMode)("ngIfElse",Jt),t.xp6(5),t.Q6J("ngIf",K.currentReportEdit===e.id)("ngIfElse",Dt)}}const xt=[{path:"",component:vt._,children:[{path:"",redirectTo:"reports",pathMatch:"full"},{path:"users",component:St},{path:"reports",component:(()=>{class r{constructor(e,n,i,a,u,v,k,Mt){this.usersService=e,this.reportsService=n,this.storesService=i,this.dialogService=a,this.fb=u,this.formValidators=v,this.papa=k,this.toastrService=Mt,this.loading=!0,this.customColumn="client",this.isNewReportVisible=!1,this.currentReportEdit="",this.revisionMode=!1,this.stores=[{label:"Maple Shade",value:1},{label:"Nissan",value:2},{label:"Trooper",value:3},{label:"Philadelphia",value:4}],this.toastrPositions=l.fe3,this.tableHeaders=["Client","Sales Person","Picture","Paid ","Positive","Rating","Submited","Plaform","Actions"],this.booleanDropOptions=[{label:"Yes",value:!0},{label:"No",value:!1}]}ngOnInit(){this.loadStoresAndReports(),this.createReportForm()}getReports$(e){this.reports=[],this.loading=!0;let n=`sortBy=createdAt:desc&store=${this.currentStoreName}`;for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n+=`&${i}=${e[i]}`);return this.reportsService.getAll(n).pipe((0,Tt.b)(i=>this.loading=!1))}loadStoresAndReports(){this.storesService.getAll().pipe((0,Y.w)(e=>(this.stores=e.map(n=>({label:n.name,value:n.id})),this.selectedStore=this.currentStoreName||this.stores[0].value,(0,st.D)([this.getReports$(),this.usersService.getAll("role=user&sortBy=createdAt:desc")])))).subscribe(([e,n])=>{this.users=n.results,this.salesPeople=n.results.map(i=>({label:i.name,value:i.id})),this.loadReportList(e)})}get currentStoreName(){return this.stores.find(e=>e.value===this.selectedStore)?.label||void 0}loadReportList(e){this.pagination={limit:e.limit,page:e.page,totalPages:e.totalPages,totalResults:e.totalResults},this.reports=e.results.map(n=>({...n,salesPerson:this.users.find(i=>("id"in i?i.id:"")===n.salesPerson)})),console.log(this.reports)}editReport(e=""){this.currentReportEdit=e,this.isNewReportVisible=!1}showAddReport(e=!0){this.currentReportEdit="",this.isNewReportVisible=e,e||this.reportForm.reset(),this.createReportForm()}createReportForm(){this.reportForm=this.fb.group({client:["",[S.kI.required]],salesPerson:["",[S.kI.required]],picture:[!1,[this.formValidators.boolean()]],paid:[null,[this.formValidators.numeric()]],positive:[null,[this.formValidators.boolean()]],rating:[null,[this.formValidators.numeric()]],submitted:[null,[this.formValidators.date()]],platform:[null,[]]})}updateNewReport(e,n,i){i&&(e=e.srcElement?.value),e.label&&(e=e.value),this.reportForm.get(n)?.setValue(e)}onCreateReportSubmit(){const e={...this.reportForm.value,store:this.currentStoreName};this.reportsService.createReport(e).subscribe(n=>{this.showAddReport(!1),this.reports.unshift({...n,salesPerson:this.users.find(i=>("id"in i?i.id:"")===n.salesPerson)})})}onEditReportRecordSubmit(){this.currentEditedReport?.id&&this.reportsService.updateReport(this.currentEditedReport?.id,this.currentEditedReport).pipe((0,Y.w)(e=>(this.currentReportEdit="",this.currentEditedReport=void 0,this.showToastr("The review has been updated."),this.getReports$()))).subscribe(e=>{this.loadReportList(e)})}updateReport(e,n,i,a){if(a&&(e=e.srcElement?.value),e.label&&(e=e.value),this.revisionMode){const u=Number(i);let v={...this.reports[u],[n]:"salesPerson"===n?this.users.find(k=>e===k.id):e};this.reports[u]=v}else{if(this.currentReportEdit)return this.currentEditedReport||(this.currentEditedReport=this.reports.find(u=>u.id===i)),void(this.currentEditedReport&&(this.currentEditedReport={...this.currentEditedReport,salesPerson:this.users.find(u=>("id"in u?u.id:"")===this.currentEditedReport?.salesPerson),[n]:e}));this.reportsService.updateReport(i.toString(),{[n]:e}).subscribe(u=>console.log("updated ",u))}}deleteRegister(e,n){this.revisionMode?this.reports.splice(n,1):this.dialogService.open(_t,{context:{icon:"alert-triangle",title:"Delete register",message:"Are you sure you want to delete this register?"}}).onClose.pipe((0,Y.w)(i=>i?this.reportsService.deleteReport(e.toString()):(0,nt.of)({}))).subscribe(i=>{if(!i.id)return;const a=this.reports.findIndex(u=>u.id===i.id);this.reports.splice(a,1)})}parseCSV(e){this.papa.parse(e,{header:!0,skipEmptyLines:!0,complete:n=>{this.uploadFile(new s(n.data).mapped)},error:n=>({error:n})})}onFileSelected(e){const n=e.target.files[0];if(n?.name.endsWith(".csv")){const i=new FileReader;i.onload=a=>{this.parseCSV(a.target.result)},i.readAsText(n)}}uploadFile(e){e?.error||(this.selectedStore=void 0,this.revisionMode=!0,this.reports=e)}onSaveImport(){if(!this.selectedStore)return;const e=this.reports.map(n=>{const i=n.salesPerson;return{...n,salesPerson:i?.id,store:this.currentStoreName}});this.reportsService.createMultipleReport(e).pipe((0,wt.K)(n=>(0,nt.of)({error:n}))).subscribe(n=>{n.error||(this.revisionMode=!1,this.getReports$().subscribe(i=>this.loadReportList(i)))})}onCancelImport(){this.revisionMode=!1,this.selectedStore=this.currentStoreName||this.stores[0].value,this.getReports$().subscribe(e=>this.loadReportList(e))}onStoreSelect(e){this.getReports$().subscribe(n=>this.loadReportList(n))}onPageChange(e){this.getReports$({page:e}).subscribe(n=>this.loadReportList(n))}showToastr(e,n="Success",i=this.toastrPositions.BOTTOM_LEFT){this.toastrService.show(n,e,{position:i,status:n.toLowerCase()})}static#t=this.\u0275fac=function(n){return new(n||r)(t.Y36(ot),t.Y36(o.V),t.Y36(c),t.Y36(l.Gln),t.Y36(S.qu),t.Y36(T.w),t.Y36(b),t.Y36(l.quB))};static#e=this.\u0275cmp=t.Xpm({type:r,selectors:[["app-reports"]],features:[t._Bn([T.w])],decls:15,vars:14,consts:[[1,"reports","flex","flex-col","h-full"],[4,"ngIf","ngIfElse"],["createReportButtons",""],["nbSpinnerStatus","primary",1,"reports-list","grow",3,"nbSpinner"],[3,"formGroup","ngSubmit"],[1,"divide-muted-200","min-w-full","table-fixed","divide-y","mb-5"],["class","text-muted-700 text-center font-sans font-bold text-sm uppercase border-muted-200 border-r p-3 last:border-e-none",4,"ngFor","ngForOf"],[1,"divide-muted-200","divide-y"],[4,"ngIf"],[3,"bg-violet-100",4,"ngFor","ngForOf"],[3,"pagination","onPageChange"],[1,"flex","justify-center","mb-4","gap-4"],["nbPrefix","","icon","home-outline"],["placeholder","Select Store","size","large",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["nbButton","","nbPopoverTrigger","hint","nbPopoverPlacement","top","status","primary","size","large",3,"nbPopover","disabled","click"],["icon","save-outline"],["nbButton","","status","danger","type","button","size","large",3,"click"],["icon","close-outline"],[3,"value"],[1,"flex","justify-between","mb-4"],[1,"flex","gap-3"],["placeholder","Select Showcase","size","large",3,"ngModel","ngModelChange","selectedChange"],["type","file","accept",".csv",1,"hidden",3,"change"],["fileUpload",""],["nbButton","","status","primary","size","large",3,"click"],["icon","upload-outline"],["icon","plus"],[1,"text-muted-700","text-center","font-sans","font-bold","text-sm","uppercase","border-muted-200","border-r","p-3","last:border-e-none"],[1,"bg-violet-100"],[1,"text-sm","text-muted-500"],["formControlName","client","type","text","nbInput","","fieldSize","small"],[3,"fieldSize","options","onOptionChange"],[1,"text-sm","text-muted-800","capitalize","text-center"],["formControlName","paid","type","number","nbInput","","fieldSize","small",1,"text-right","w-20"],[1,"text-sm","text-muted-800","text-center"],["formControlName","rating","type","number","nbInput","","fieldSize","small",1,"text-right","w-20"],["nbInput","","formControlName","submitted","fieldSize","small","placeholder","Date","format","dd.MM.yyyy",1,"text-center","w-36",3,"nbDatepicker"],["datepicker",""],["formControlName","platform","type","text","nbInput","","fieldSize","small",1,"text-center","w-32"],[1,"flex","gap-2","justify-center"],["nbButton","","size","small","status","primary"],["nbButton","","size","small",3,"click"],[1,"whitespace-nowrap","text-sm","text-muted-500"],["inputClient",""],["inputSalesPerson",""],[1,"whitespace-nowrap","text-sm","text-muted-800","uppercase","text-center"],["inputPicture",""],["inputPaid",""],["inputPositive",""],[1,"whitespace-nowrap","text-sm","text-muted-800","text-center"],["inputRating",""],["inputSubmitted",""],["inputPlatform",""],[1,"p-1"],["inputActions",""],["type","text","nbInput","","fieldSize","small",1,"w-44",3,"value","blur","keydown.enter"],[3,"value","fieldSize","options","onOptionChange"],["type","number","nbInput","","fieldSize","small",1,"text-right","w-20",3,"value","blur","keydown.enter"],[3,"fieldSize","value","options","onOptionChange"],["nbInput","","fieldSize","small","placeholder","Date","format","dd.MM.yyyy",1,"text-center","w-36",3,"value","nbDatepicker"],[3,"dateChange"],["type","string","nbInput","","fieldSize","small",1,"text-center","w-32",3,"value","blur","keydown.enter"],["nbButton","","type","button","size","small","status","primary",3,"click"],["nbButton","","type","button","size","small",3,"click"],["nbButton","","type","button","size","small","status","primary",3,"click",4,"ngIf"],["nbButton","","type","button","size","small","status","danger",3,"click"],["icon","trash-outline"],["icon","edit-outline"]],template:function(n,i){if(1&n&&(t.TgZ(0,"div",0),t.YNc(1,L,12,4,"ng-container",1),t.YNc(2,z,15,2,"ng-template",null,2,t.W1O),t.TgZ(4,"nb-card",3)(5,"nb-card-body")(6,"form",4),t.NdJ("ngSubmit",function(){return i.onCreateReportSubmit()}),t.TgZ(7,"table",5)(8,"thead")(9,"tr"),t.YNc(10,g,2,1,"th",6),t.qZA()(),t.TgZ(11,"tbody",7),t.YNc(12,y,26,11,"ng-container",8),t.YNc(13,lt,38,20,"tr",9),t.qZA()()()()(),t.TgZ(14,"app-pagination",10),t.NdJ("onPageChange",function(u){return i.onPageChange(u)}),t.qZA()()),2&n){const a=t.MAs(3);t.xp6(1),t.Q6J("ngIf",i.revisionMode)("ngIfElse",a),t.xp6(3),t.ekj("bg-violet-100",i.revisionMode),t.Q6J("nbSpinner",i.loading),t.xp6(2),t.Q6J("formGroup",i.reportForm),t.xp6(2),t.ekj("bg-violet-200",i.revisionMode),t.xp6(2),t.Q6J("ngForOf",i.tableHeaders),t.xp6(1),t.ekj("bg-violet-100",i.revisionMode),t.xp6(1),t.Q6J("ngIf",i.isNewReportVisible),t.xp6(1),t.Q6J("ngForOf",i.reports),t.xp6(1),t.Q6J("pagination",i.pagination)}},dependencies:[S._Y,S.Fj,S.wV,S.JJ,S.JL,S.sg,S.u,j.sg,j.O5,S.On,l.Asz,l.yKW,l.Q7R,l.DPz,l.fMN,l.jBG,l.t3q,l.h8i,l.ydg,l.rs,l.q51,P,B,l.$kf,l.B4C,j.uU,d,E,q],styles:["td[_ngcontent-%COMP%]:last-child{border-right:medium none}"]})}return r})()}]}];let V=(()=>{class r{static#t=this.\u0275fac=function(n){return new(n||r)};static#e=this.\u0275mod=t.oAB({type:r});static#n=this.\u0275inj=t.cJS({imports:[mt.Bz.forChild(xt),mt.Bz]})}return r})();var Rt=w(7845),Ct=w(9862);let Ut=(()=>{class r extends ot{constructor(e){super(),this.http=e,this.url=Rt.N.apiURL}getAll(e){return this.http.get(e?`${this.url}/users?${e}`:`${this.url}/users`)}createUser(e,n,i){return this.http.post(`${this.url}/users`,{name:e,email:n,role:i})}deleteUser(e){return this.http.delete(`${this.url}/users/${e}`)}getById(e){return this.http.get(`${this.url}/users/${e}`)}updateUser(e){return this.http.patch(`${this.url}/users/${e.id}`,{email:e.email,name:e.name,role:e.role})}static#t=this.\u0275fac=function(n){return new(n||r)(t.LFG(Ct.eN))};static#e=this.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var Nt=w(6208),Pt=w(7428);let It=(()=>{class r extends c{constructor(e){super(),this.http=e,this.url=Rt.N.apiURL}getAll(e){return this.http.get(e?`${this.url}/stores?${e}`:`${this.url}/stores`)}createStore(e,n){return this.http.post(`${this.url}/stores`,{name:e,active:n})}deleteStore(e){return this.http.delete(`${this.url}/stores/${e}`)}updateStore(e,n){return this.http.patch(`${this.url}/stores/${e}`,n)}static#t=this.\u0275fac=function(n){return new(n||r)(t.LFG(Ct.eN))};static#e=this.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})(),Ft=(()=>{class r{static#t=this.\u0275fac=function(n){return new(n||r)};static#e=this.\u0275mod=t.oAB({type:r});static#n=this.\u0275inj=t.cJS({providers:[{provide:ot,useClass:Ut},{provide:o.V,useClass:Pt.F},{provide:c,useClass:It}],imports:[V,S.UX,mt.Bz,j.ez,S.u5,l.zyh,l.uuI,l.BW0,l.T2N,l.KdK,l.AE1,ft.S,l.V7y,l.nKr,l.spT,l.wB1,l.IIj,l.caZ,l.HKp,Nt.m,l.LW9.forRoot(),l.j7H.forRoot(),l.P1.forRoot(),l.j5J.forRoot(),l.OA.forRoot()]})}return r})()},4316:function(Ot,kt){var w,j;w=function S(){"use strict";var l=typeof self<"u"?self:typeof window<"u"?window:void 0!==l?l:{},ft=!l.document&&!!l.postMessage,vt=l.IS_PAPA_WORKER||!1,t={},Zt=0,x={parse:function(s,o){var c=(o=o||{}).dynamicTyping||!1;if(T(c)&&(o.dynamicTypingFunction=c,c={}),o.dynamicTyping=c,o.transform=!!T(o.transform)&&o.transform,o.worker&&x.WORKERS_SUPPORTED){var p=function(){if(!x.WORKERS_SUPPORTED)return!1;var $,U,b=($=l.URL||l.webkitURL||null,U=S.toString(),x.BLOB_URL||(x.BLOB_URL=$.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",U,")();"],{type:"text/javascript"})))),C=new l.Worker(b);return C.onmessage=Et,C.id=Zt++,t[C.id]=C}();return p.userStep=o.step,p.userChunk=o.chunk,p.userComplete=o.complete,p.userError=o.error,o.step=T(o.step),o.chunk=T(o.chunk),o.complete=T(o.complete),o.error=T(o.error),delete o.worker,void p.postMessage({input:s,config:o,workerId:p.id})}var b,_=null;return"string"==typeof s?(s=65279===(b=s).charCodeAt(0)?b.slice(1):b,_=o.download?new nt(o):new gt(o)):!0===s.readable&&T(s.read)&&T(s.on)?_=new bt(o):(l.File&&s instanceof File||s instanceof Object)&&(_=new ot(o)),_.stream(s)},unparse:function(s,o){var c=!1,p=!0,_=",",b="\r\n",C='"',$=C+C,U=!1,h=null,P=!1;!function(){if("object"==typeof o){if("string"!=typeof o.delimiter||x.BAD_DELIMITERS.filter(function(d){return-1!==o.delimiter.indexOf(d)}).length||(_=o.delimiter),("boolean"==typeof o.quotes||"function"==typeof o.quotes||Array.isArray(o.quotes))&&(c=o.quotes),"boolean"!=typeof o.skipEmptyLines&&"string"!=typeof o.skipEmptyLines||(U=o.skipEmptyLines),"string"==typeof o.newline&&(b=o.newline),"string"==typeof o.quoteChar&&(C=o.quoteChar),"boolean"==typeof o.header&&(p=o.header),Array.isArray(o.columns)){if(0===o.columns.length)throw new Error("Option columns is empty");h=o.columns}void 0!==o.escapeChar&&($=o.escapeChar+C),("boolean"==typeof o.escapeFormulae||o.escapeFormulae instanceof RegExp)&&(P=o.escapeFormulae instanceof RegExp?o.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var m=new RegExp(pt(C),"g");if("string"==typeof s&&(s=JSON.parse(s)),Array.isArray(s)){if(!s.length||Array.isArray(s[0]))return X(null,s,U);if("object"==typeof s[0])return X(h||Object.keys(s[0]),s,U)}else if("object"==typeof s)return"string"==typeof s.data&&(s.data=JSON.parse(s.data)),Array.isArray(s.data)&&(s.fields||(s.fields=s.meta&&s.meta.fields||h),s.fields||(s.fields=Array.isArray(s.data[0])?s.fields:"object"==typeof s.data[0]?Object.keys(s.data[0]):[]),Array.isArray(s.data[0])||"object"==typeof s.data[0]||(s.data=[s.data])),X(s.fields||[],s.data||[],U);throw new Error("Unable to serialize unrecognized input");function X(d,E,q){var N="";"string"==typeof d&&(d=JSON.parse(d)),"string"==typeof E&&(E=JSON.parse(E));var L=Array.isArray(d)&&0<d.length,D=!Array.isArray(E[0]);if(L&&p){for(var z=0;z<d.length;z++)0<z&&(N+=_),N+=B(d[z],z);0<E.length&&(N+=b)}for(var g=0;g<E.length;g++){var y=L?d.length:E[g].length,M=!1,J=L?0===Object.keys(E[g]).length:0===E[g].length;if(q&&!L&&(M="greedy"===q?""===E[g].join("").trim():1===E[g].length&&0===E[g][0].length),"greedy"===q&&L){for(var A=[],Q=0;Q<y;Q++)A.push(E[g][D?d[Q]:Q]);M=""===A.join("").trim()}if(!M){for(var Z=0;Z<y;Z++)0<Z&&!J&&(N+=_),N+=B(E[g][L&&D?d[Z]:Z],Z);g<E.length-1&&(!q||0<y&&!J)&&(N+=b)}}return N}function B(d,E){if(null==d)return"";if(d.constructor===Date)return JSON.stringify(d).slice(1,25);var q=!1;P&&"string"==typeof d&&P.test(d)&&(d="'"+d,q=!0);var N=d.toString().replace(m,$);return(q=q||!0===c||"function"==typeof c&&c(d,E)||Array.isArray(c)&&c[E]||function(L,D){for(var z=0;z<D.length;z++)if(-1<L.indexOf(D[z]))return!0;return!1}(N,x.BAD_DELIMITERS)||-1<N.indexOf(_)||" "===N.charAt(0)||" "===N.charAt(N.length-1))?C+N+C:N}}};if(x.RECORD_SEP=String.fromCharCode(30),x.UNIT_SEP=String.fromCharCode(31),x.BYTE_ORDER_MARK="\ufeff",x.BAD_DELIMITERS=["\r","\n",'"',x.BYTE_ORDER_MARK],x.WORKERS_SUPPORTED=!ft&&!!l.Worker,x.NODE_STREAM_INPUT=1,x.LocalChunkSize=10485760,x.RemoteChunkSize=5242880,x.DefaultDelimiter=",",x.Parser=yt,x.ParserHandle=wt,x.NetworkStreamer=nt,x.FileStreamer=ot,x.StringStreamer=gt,x.ReadableStreamStreamer=bt,l.jQuery){var _t=l.jQuery;_t.fn.parse=function(s){var o=s.config||{},c=[];return this.each(function(b){if("INPUT"!==_t(this).prop("tagName").toUpperCase()||"file"!==_t(this).attr("type").toLowerCase()||!l.FileReader||!this.files||0===this.files.length)return!0;for(var C=0;C<this.files.length;C++)c.push({file:this.files[C],inputElem:this,instanceConfig:_t.extend({},o)})}),p(),this;function p(){if(0!==c.length){var C,$,U,h=c[0];if(T(s.before)){var P=s.before(h.file,h.inputElem);if("object"==typeof P){if("abort"===P.action)return"AbortError",C=h.file,$=h.inputElem,U=P.reason,void(T(s.error)&&s.error({name:"AbortError"},C,$,U));if("skip"===P.action)return void _();"object"==typeof P.config&&(h.instanceConfig=_t.extend(h.instanceConfig,P.config))}else if("skip"===P)return void _()}var m=h.instanceConfig.complete;h.instanceConfig.complete=function(X){T(m)&&m(X,h.file,h.inputElem),_()},x.parse(h.file,h.instanceConfig)}else T(s.complete)&&s.complete()}function _(){c.splice(0,1),p()}}}function Y(s){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(o){var c=Tt(o);c.chunkSize=parseInt(c.chunkSize),o.step||o.chunk||(c.chunkSize=null),this._handle=new wt(c),(this._handle.streamer=this)._config=c}.call(this,s),this.parseChunk=function(o,c){if(this.isFirstChunk&&T(this._config.beforeFirstChunk)){var p=this._config.beforeFirstChunk(o);void 0!==p&&(o=p)}this.isFirstChunk=!1,this._halted=!1;var _=this._partialLine+o;this._partialLine="";var b=this._handle.parse(_,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var C=b.meta.cursor;this._finished||(this._partialLine=_.substring(C-this._baseIndex),this._baseIndex=C),b&&b.data&&(this._rowCount+=b.data.length);var $=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(vt)l.postMessage({results:b,workerId:x.WORKER_ID,finished:$});else if(T(this._config.chunk)&&!c){if(this._config.chunk(b,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);b=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(b.data),this._completeResults.errors=this._completeResults.errors.concat(b.errors),this._completeResults.meta=b.meta),this._completed||!$||!T(this._config.complete)||b&&b.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),$||b&&b.meta.paused||this._nextChunk(),b}this._halted=!0},this._sendError=function(o){T(this._config.error)?this._config.error(o):vt&&this._config.error&&l.postMessage({workerId:x.WORKER_ID,error:o,finished:!1})}}function nt(s){var o;(s=s||{}).chunkSize||(s.chunkSize=x.RemoteChunkSize),Y.call(this,s),this._nextChunk=ft?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(c){this._input=c,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(o=new XMLHttpRequest,this._config.withCredentials&&(o.withCredentials=this._config.withCredentials),ft||(o.onload=st(this._chunkLoaded,this),o.onerror=st(this._chunkError,this)),o.open(this._config.downloadRequestBody?"POST":"GET",this._input,!ft),this._config.downloadRequestHeaders){var c=this._config.downloadRequestHeaders;for(var p in c)o.setRequestHeader(p,c[p])}this._config.chunkSize&&o.setRequestHeader("Range","bytes="+this._start+"-"+(this._start+this._config.chunkSize-1));try{o.send(this._config.downloadRequestBody)}catch(b){this._chunkError(b.message)}ft&&0===o.status&&this._chunkError()}},this._chunkLoaded=function(){var p;4===o.readyState&&(o.status<200||400<=o.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:o.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null===(p=o.getResponseHeader("Content-Range"))?-1:parseInt(p.substring(p.lastIndexOf("/")+1))),this.parseChunk(o.responseText)))},this._chunkError=function(c){this._sendError(new Error(o.statusText||c))}}function ot(s){var o,c;(s=s||{}).chunkSize||(s.chunkSize=x.LocalChunkSize),Y.call(this,s);var p=typeof FileReader<"u";this.stream=function(_){this._input=_,c=_.slice||_.webkitSlice||_.mozSlice,p?((o=new FileReader).onload=st(this._chunkLoaded,this),o.onerror=st(this._chunkError,this)):o=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var _=this._input;if(this._config.chunkSize){var b=Math.min(this._start+this._config.chunkSize,this._input.size);_=c.call(_,this._start,b)}var C=o.readAsText(_,this._config.encoding);p||this._chunkLoaded({target:{result:C}})},this._chunkLoaded=function(_){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(_.target.result)},this._chunkError=function(){this._sendError(o.error)}}function gt(s){var o;Y.call(this,s=s||{}),this.stream=function(c){return o=c,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var c,p=this._config.chunkSize;return p?(c=o.substring(0,p),o=o.substring(p)):(c=o,o=""),this._finished=!o,this.parseChunk(c)}}}function bt(s){Y.call(this,s=s||{});var o=[],c=!0,p=!1;this.pause=function(){Y.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){Y.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(_){this._input=_,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){p&&1===o.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),o.length?this.parseChunk(o.shift()):c=!0},this._streamData=st(function(_){try{o.push("string"==typeof _?_:_.toString(this._config.encoding)),c&&(c=!1,this._checkIsFinished(),this.parseChunk(o.shift()))}catch(b){this._streamError(b)}},this),this._streamError=st(function(_){this._streamCleanUp(),this._sendError(_)},this),this._streamEnd=st(function(){this._streamCleanUp(),p=!0,this._streamData("")},this),this._streamCleanUp=st(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function wt(s){var o,c,p,_=Math.pow(2,53),b=-_,C=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,$=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,U=this,h=0,P=0,m=!1,X=!1,B=[],d={data:[],errors:[],meta:{}};if(T(s.step)){var E=s.step;s.step=function(g){if(d=g,L())N();else{if(N(),0===d.data.length)return;h+=g.data.length,s.preview&&h>s.preview?c.abort():(d.data=d.data[0],E(d,U))}}}function q(g){return"greedy"===s.skipEmptyLines?""===g.join("").trim():1===g.length&&0===g[0].length}function N(){return d&&p&&(z("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+x.DefaultDelimiter+"'"),p=!1),s.skipEmptyLines&&(d.data=d.data.filter(function(g){return!q(g)})),L()&&function(){if(d)if(Array.isArray(d.data[0])){for(var y=0;L()&&y<d.data.length;y++)d.data[y].forEach(g);d.data.splice(0,1)}else d.data.forEach(g);function g(M,J){T(s.transformHeader)&&(M=s.transformHeader(M,J)),B.push(M)}}(),function(){if(!d||!s.header&&!s.dynamicTyping&&!s.transform)return d;function g(M,J){var A,Q=s.header?{}:[];for(A=0;A<M.length;A++){var I=A,Z=M[A];s.header&&(I=A>=B.length?"__parsed_extra":B[A]),s.transform&&(Z=s.transform(Z,I)),Z=D(I,Z),"__parsed_extra"===I?(Q[I]=Q[I]||[],Q[I].push(Z)):Q[I]=Z}return s.header&&(A>B.length?z("FieldMismatch","TooManyFields","Too many fields: expected "+B.length+" fields but parsed "+A,P+J):A<B.length&&z("FieldMismatch","TooFewFields","Too few fields: expected "+B.length+" fields but parsed "+A,P+J)),Q}var y=1;return!d.data.length||Array.isArray(d.data[0])?(d.data=d.data.map(g),y=d.data.length):d.data=g(d.data,0),s.header&&d.meta&&(d.meta.fields=B),P+=y,d}()}function L(){return s.header&&0===B.length}function D(g,y){return M=g,s.dynamicTypingFunction&&void 0===s.dynamicTyping[M]&&(s.dynamicTyping[M]=s.dynamicTypingFunction(M)),!0===(s.dynamicTyping[M]||s.dynamicTyping)?"true"===y||"TRUE"===y||"false"!==y&&"FALSE"!==y&&(function(J){if(C.test(J)){var A=parseFloat(J);if(b<A&&A<_)return!0}return!1}(y)?parseFloat(y):$.test(y)?new Date(y):""===y?null:y):y;var M}function z(g,y,M,J){var A={type:g,code:y,message:M};void 0!==J&&(A.row=J),d.errors.push(A)}this.parse=function(g,y,M){if(s.newline||(s.newline=function(I,Z){I=I.substring(0,1048576);var tt=new RegExp(pt(Z)+"([^]*?)"+pt(Z),"gm"),H=(I=I.replace(tt,"")).split("\r"),et=I.split("\n");if(1===H.length||1<et.length&&et[0].length<H[0].length)return"\n";for(var G=0,O=0;O<H.length;O++)"\n"===H[O][0]&&G++;return G>=H.length/2?"\r\n":"\r"}(g,s.quoteChar||'"')),p=!1,s.delimiter)T(s.delimiter)&&(s.delimiter=s.delimiter(g),d.meta.delimiter=s.delimiter);else{var A=function(I,Z,tt,H,et){var rt,G,O,F;et=et||[",","\t","|",";",x.RECORD_SEP,x.UNIT_SEP];for(var ut=0;ut<et.length;ut++){var R=et[ut],ht=0,it=0,dt=0;O=void 0;for(var at=new yt({comments:H,delimiter:R,newline:Z,preview:10}).parse(I),ct=0;ct<at.data.length;ct++)if(tt&&q(at.data[ct]))dt++;else{var lt=at.data[ct].length;it+=lt,void 0!==O?0<lt&&(ht+=Math.abs(lt-O),O=lt):O=lt}0<at.data.length&&(it/=at.data.length-dt),(void 0===G||ht<=G)&&(void 0===F||F<it)&&1.99<it&&(G=ht,rt=R,F=it)}return{successful:!!(s.delimiter=rt),bestDelimiter:rt}}(g,s.newline,s.skipEmptyLines,s.comments,s.delimitersToGuess);A.successful?s.delimiter=A.bestDelimiter:(p=!0,s.delimiter=x.DefaultDelimiter),d.meta.delimiter=s.delimiter}var Q=Tt(s);return s.preview&&s.header&&Q.preview++,o=g,c=new yt(Q),d=c.parse(o,y,M),N(),m?{meta:{paused:!0}}:d||{meta:{paused:!1}}},this.paused=function(){return m},this.pause=function(){m=!0,c.abort(),o=T(s.chunk)?"":o.substring(c.getCharIndex())},this.resume=function(){U.streamer._halted?(m=!1,U.streamer.parseChunk(o,!0)):setTimeout(U.resume,3)},this.aborted=function(){return X},this.abort=function(){X=!0,c.abort(),d.meta.aborted=!0,T(s.complete)&&s.complete(d),o=""}}function pt(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function yt(s){var o,c=(s=s||{}).delimiter,p=s.newline,_=s.comments,b=s.step,C=s.preview,$=s.fastMode,U=o=null==s.quoteChar?'"':s.quoteChar;if(void 0!==s.escapeChar&&(U=s.escapeChar),("string"!=typeof c||-1<x.BAD_DELIMITERS.indexOf(c))&&(c=","),_===c)throw new Error("Comment character same as delimiter");!0===_?_="#":("string"!=typeof _||-1<x.BAD_DELIMITERS.indexOf(_))&&(_=!1),"\n"!==p&&"\r"!==p&&"\r\n"!==p&&(p="\n");var h=0,P=!1;this.parse=function(m,X,B){if("string"!=typeof m)throw new Error("Input must be a string");var d=m.length,E=c.length,q=p.length,N=_.length,L=T(b),D=[],z=[],g=[],y=h=0;if(!m)return W();if(s.header&&!X){var M=m.split(p)[0].split(c),J=[],A={},Q=!1;for(var I in M){var Z=M[I];T(s.transformHeader)&&(Z=s.transformHeader(Z,I));var tt=Z,H=A[Z]||0;for(0<H&&(Q=!0,tt=Z+"_"+H),A[Z]=H+1;J.includes(tt);)tt=tt+"_"+H;J.push(tt)}if(Q){var et=m.split(p);et[0]=J.join(c),m=et.join(p)}}if($||!1!==$&&-1===m.indexOf(o)){for(var rt=m.split(p),G=0;G<rt.length;G++){if(h+=(g=rt[G]).length,G!==rt.length-1)h+=p.length;else if(B)return W();if(!_||g.substring(0,N)!==_){if(L){if(D=[],dt(g.split(c)),xt(),P)return W()}else dt(g.split(c));if(C&&C<=G)return D=D.slice(0,C),W(!0)}}return W()}for(var O=m.indexOf(c,h),F=m.indexOf(p,h),ut=new RegExp(pt(U)+pt(o),"g"),R=m.indexOf(o,h);;)if(m[h]!==o)if(_&&0===g.length&&m.substring(h,h+N)===_){if(-1===F)return W();F=m.indexOf(p,h=F+q),O=m.indexOf(c,h)}else if(-1!==O&&(O<F||-1===F))g.push(m.substring(h,O)),O=m.indexOf(c,h=O+E);else{if(-1===F)break;if(g.push(m.substring(h,F)),lt(F+q),L&&(xt(),P))return W();if(C&&D.length>=C)return W(!0)}else for(R=h,h++;;){if(-1===(R=m.indexOf(o,R+1)))return B||z.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:D.length,index:h}),ct();if(R===d-1)return ct(m.substring(h,R).replace(ut,o));if(o!==U||m[R+1]!==U){if(o===U||0===R||m[R-1]!==U){-1!==O&&O<R+1&&(O=m.indexOf(c,R+1)),-1!==F&&F<R+1&&(F=m.indexOf(p,R+1));var ht=at(-1===F?O:Math.min(O,F));if(m.substr(R+1+ht,E)===c){g.push(m.substring(h,R).replace(ut,o)),m[h=R+1+ht+E]!==o&&(R=m.indexOf(o,h)),O=m.indexOf(c,h),F=m.indexOf(p,h);break}var it=at(F);if(m.substring(R+1+it,R+1+it+q)===p){if(g.push(m.substring(h,R).replace(ut,o)),lt(R+1+it+q),O=m.indexOf(c,h),R=m.indexOf(o,h),L&&(xt(),P))return W();if(C&&D.length>=C)return W(!0);break}z.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:D.length,index:h}),R++}}else R++}return ct();function dt(V){D.push(V),y=h}function at(V){var Rt=0;if(-1!==V){var Ct=m.substring(R+1,V);Ct&&""===Ct.trim()&&(Rt=Ct.length)}return Rt}function ct(V){return B||(void 0===V&&(V=m.substring(h)),g.push(V),h=d,dt(g),L&&xt()),W()}function lt(V){h=V,dt(g),g=[],F=m.indexOf(p,h)}function W(V){return{data:D,errors:z,meta:{delimiter:c,linebreak:p,aborted:P,truncated:!!V,cursor:y+(X||0)}}}function xt(){b(W()),D=[],z=[]}},this.abort=function(){P=!0},this.getCharIndex=function(){return h}}function Et(s){var o=s.data,c=t[o.workerId],p=!1;if(o.error)c.userError(o.error,o.file);else if(o.results&&o.results.data){var _={abort:function(){p=!0,At(o.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:St,resume:St};if(T(c.userStep)){for(var b=0;b<o.results.data.length&&(c.userStep({data:o.results.data[b],errors:o.results.errors,meta:o.results.meta},_),!p);b++);delete o.results}else T(c.userChunk)&&(c.userChunk(o.results,_,o.file),delete o.results)}o.finished&&!p&&At(o.workerId,o.results)}function At(s,o){var c=t[s];T(c.userComplete)&&c.userComplete(o),c.terminate(),delete t[s]}function St(){throw new Error("Not implemented.")}function Tt(s){if("object"!=typeof s||null===s)return s;var o=Array.isArray(s)?[]:{};for(var c in s)o[c]=Tt(s[c]);return o}function st(s,o){return function(){s.apply(o,arguments)}}function T(s){return"function"==typeof s}return vt&&(l.onmessage=function(s){var o=s.data;if(void 0===x.WORKER_ID&&o&&(x.WORKER_ID=o.workerId),"string"==typeof o.input)l.postMessage({workerId:x.WORKER_ID,results:x.parse(o.input,o.config),finished:!0});else if(l.File&&o.input instanceof File||o.input instanceof Object){var c=x.parse(o.input,o.config);c&&l.postMessage({workerId:x.WORKER_ID,results:c,finished:!0})}}),(nt.prototype=Object.create(Y.prototype)).constructor=nt,(ot.prototype=Object.create(Y.prototype)).constructor=ot,(gt.prototype=Object.create(gt.prototype)).constructor=gt,(bt.prototype=Object.create(Y.prototype)).constructor=bt,x},void 0!==(j=w.apply(kt,[]))&&(Ot.exports=j)}}]);